<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Toko Sederhana</title>
  <style>
    :root{--bg:#f9fafb;--card:#ffffff;--accent:#2563eb;--muted:#6b7280}
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial}
    body{margin:0;min-height:100vh;background:var(--bg);padding:20px}
    h1{margin-bottom:20px;text-align:center}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:18px}
    .card{background:var(--card);border-radius:12px;box-shadow:0 4px 14px rgba(0,0,0,0.06);padding:14px;display:flex;flex-direction:column;align-items:center}
    .card img{width:100%;height:160px;object-fit:cover;border-radius:8px}
    .card h2{margin:10px 0 4px;font-size:16px;text-align:center}
    .card p{margin:0;color:var(--muted);font-size:14px}
    .btn{margin-top:10px;padding:8px 12px;border-radius:8px;border:0;background:var(--accent);color:#fff;font-weight:600;cursor:pointer}
    .qty{margin-top:8px;display:flex;align-items:center;gap:6px}
    .qty input{width:60px;padding:6px 8px;border:1px solid #ddd;border-radius:6px;text-align:center}
    .hidden{display:none}
    #cartInfo{margin:20px 0;text-align:center;font-size:14px}

    .cart-fab{position:fixed;right:20px;bottom:20px;width:60px;height:60px;border-radius:50%;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,0.2);font-size:26px}
  </style>
</head>
<body>
  <h1>Daftar Produk</h1>
  <div id="cartInfo">Keranjang kosong</div>

  <section class="grid" id="productGrid"></section>

  <div class="cart-fab" id="cartFab">ðŸ›’</div>

  <script>
  
  function checkLogin() {
  // Ambil data user yang sedang login dari localStorage
  const loggedInUser = localStorage.getItem("loggedInUser");
  const users = JSON.parse(localStorage.getItem("users")) || [];

  // Jika tidak ada user yang login
  if (!loggedInUser) {
    alert("Silakan login terlebih dahulu!");
    window.location.href = "login.html"; // arahkan ke halaman login
    return;
  }


  
}

// Jalankan saat halaman di-load
checkLogin();
    const KEY_CART = 'cart';
    const products = [
      {id:1,name:'Telor Gulung',price:5000,img:'https://share.google/images/ijcl078eAux1QAckM'},
      {id:2,name:'Cilok Bunbu Kacang',price:5000,img:'https://share.google/images/OmUeHoTe2ldWYXGSd'},
      {id:3,name:'Cireng Isi Ayam',price:10000,img:'https://share.google/images/rdMtNdoqDobY6lYxm'},
      {id:4,name:'Air Doa',price:15000,img:'https://share.google/images/Hn3arXjkAoyLz3YpX'}
    ];

    const cart = {}; // { productId: qty }

    function formatRp(n){
      return 'Rp ' + n.toLocaleString('id-ID');
    }

    function renderProducts(){
      const grid = document.getElementById('productGrid');
      grid.innerHTML = '';
      products.forEach(p=>{
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img src="${p.img}" alt="${p.name}">
          <h2>${p.name}</h2>
          <p>${formatRp(p.price)}</p>
          <button class="btn addBtn">+ Keranjang</button>
          <div class="qty hidden">
            <label for="qty-${p.id}" class="small">Jumlah:</label>
            <input id="qty-${p.id}" type="number" min="1" value="1">
          </div>
        `;

        const addBtn = card.querySelector('.addBtn');
        const qtyBox = card.querySelector('.qty');
        const qtyInput = card.querySelector('input');

        addBtn.addEventListener('click', ()=>{
          addBtn.classList.add('hidden');
          qtyBox.classList.remove('hidden');
          cart[p.id] = parseInt(qtyInput.value,10) || 1;
          updateCartInfo();
        });

        qtyInput.addEventListener('change', ()=>{
          const val = parseInt(qtyInput.value,10);
          if(val>0){
            cart[p.id] = val;
            updateCartInfo();
          }
        });

        grid.appendChild(card);
      });
    }

    function updateCartInfo(){
      const totalItems = Object.values(cart).reduce((a,b)=>a+b,0);
      const info = document.getElementById('cartInfo');
      if(totalItems===0){
        info.textContent = 'Keranjang kosong';
      } else {
        info.textContent = `Keranjang: ${totalItems} item`;
      }
    }

    document.getElementById('cartFab').addEventListener('click', ()=>{
      localStorage.setItem(KEY_CART, JSON.stringify(cart));
      window.location.href = 'checkout.html';
    });

    renderProducts();
  </script>
</body>
</html>